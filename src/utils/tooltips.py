"""
Tooltips Module
ツールチップ・ヘルプテキスト定義モジュール

Author: Yuutai Event Investor Team
Date: 2024-11-07
"""


class Tooltips:
    """ツールチップテキストの定義"""

    # メインウィンドウ
    DATA_UPDATE_BUTTON = "優待データをWebからスクレイピングして更新します（所要時間: 約5-10分）"
    SETTINGS_BUTTON = "アプリケーション設定を開きます (Ctrl+,)"
    EXPORT_MENU = "データをCSV、JSON、PDF形式でエクスポートします"

    # フィルターパネル
    RIGHTS_MONTH_FILTER = "権利確定月で銘柄を絞り込みます。複数選択可能です。"
    WIN_RATE_FILTER = "勝率の範囲で銘柄を絞り込みます。勝率は過去のバックテスト結果から算出されます。"
    EXPECTED_RETURN_FILTER = "期待リターンの範囲で絞り込みます。期待リターン = (勝率 × 平均勝ちリターン) + ((1-勝率) × 平均負けリターン)"
    SORT_OPTION = "銘柄リストの並び替え基準を選択します"
    CLEAR_FILTERS_BUTTON = "全てのフィルター条件をクリアします (Ctrl+Shift+F)"

    # 銘柄リスト
    STOCK_LIST_ITEM = "クリックして詳細を表示。右クリックでメニューを開きます。"
    STOCK_CODE = "証券コード（4桁）"
    STOCK_NAME = "銘柄名"
    OPTIMAL_DAYS = "最も期待リターンが高い買入タイミング（権利付最終日の何営業日前か）"
    WIN_RATE = "過去のバックテスト結果から算出した勝率（リターンがプラスになる確率）"
    EXPECTED_RETURN = "期待されるリターンの平均値。期待リターン = (勝率 × 平均勝ちリターン) + ((1-勝率) × 平均負けリターン)"

    # 詳細パネル
    STOCK_INFO_CARD = "選択した銘柄の基本情報と推奨買入タイミング"
    CHART_WIDGET = "バックテスト結果をグラフで表示。複数のチャートを切り替えられます。"
    STATS_TABLE = "詳細な統計情報。勝ちトレード・負けトレードの分布を確認できます。"

    # チャート
    CHART_EXPECTED_RETURN = "買入日ごとの期待リターン推移。ピークが最適買入日です。"
    CHART_WIN_RATE = "買入日ごとの勝率。70%以上が推奨ゾーンです。"
    CHART_TRADE_HISTORY = "過去の個別トレード結果。緑が勝ち、赤が負けです。"

    # ウォッチリスト
    WATCHLIST_ADD = "選択した銘柄をウォッチリストに追加します (Ctrl+D)"
    WATCHLIST_REMOVE = "選択した銘柄をウォッチリストから削除します (Ctrl+Shift+D)"
    WATCHLIST_MEMO = "この銘柄に関するメモを入力できます"
    WATCHLIST_NOTIFICATION = "最適買入日が近づくと通知を送信します"

    # 通知設定
    NOTIFICATION_ENABLE = "通知機能を有効にします。最適買入日の数日前に通知が送られます。"
    NOTIFICATION_DAYS_BEFORE = "最適買入日の何日前に通知するか設定します"
    NOTIFICATION_TIME = "通知を送信する時刻を設定します"

    # エクスポート
    EXPORT_CSV = "銘柄リストや分析結果をCSV形式で保存します (Ctrl+E)"
    EXPORT_JSON = "データをJSON形式で保存します。他のツールとの連携に便利です。"
    EXPORT_PDF = "分析レポートをPDF形式で保存します (Ctrl+P)"
    EXPORT_SCREENSHOT = "現在の画面を画像として保存します"

    # 設定ダイアログ
    SETTINGS_DATABASE_PATH = "データベースファイルの保存場所"
    SETTINGS_DATA_UPDATE_INTERVAL = "自動データ更新の間隔（日数）"
    SETTINGS_BACKTEST_MAX_DAYS = "バックテストで検証する最大日数（権利付最終日の何日前まで）"
    SETTINGS_NOTIFICATION_INTERVAL = "通知チェックの間隔（分）"
    SETTINGS_THEME = "アプリケーションのテーマ（ダーク/ライト）"

    # バックテスト
    BACKTEST_BUTTON = "選択した銘柄のバックテストを実行します"
    BACKTEST_PROGRESS = "バックテスト実行中..."
    BACKTEST_BATCH = "全銘柄のバックテストを並列実行します。完了まで時間がかかることがあります。"


class HelpTexts:
    """ヘルプテキストの定義"""

    ABOUT = """
# Yuutai Event Investor v1.0.0

株主優待イベント投資の最適タイミングを予測・分析するデスクトップアプリケーション

## 開発チーム
Yuutai Event Investor Team

## ライセンス
MIT License

## 使用ライブラリ
- PySide6: UIフレームワーク
- pandas: データ処理
- yfinance: 株価データ取得
- matplotlib: チャート描画
- BeautifulSoup4: Webスクレイピング

## お問い合わせ
GitHub Issues: https://github.com/yourusername/yuutai_event_investor/issues
"""

    QUICK_START = """
# クイックスタートガイド

## 1. 初回起動時

### データ更新
1. メニューバーの「データ更新」ボタンをクリック
2. スクレイピングが完了するまで待機（約5-10分）
3. 銘柄リストが表示されます

## 2. 銘柄の検索と分析

### フィルター機能
- 権利確定月: 「3月優待」「12月優待」など
- 勝率: スライダーで範囲指定（例: 70%以上）
- 期待リターン: スライダーで範囲指定（例: +2%以上）

### 詳細分析
1. 銘柄リストから銘柄をクリック
2. 右側のパネルに詳細が表示されます
   - 推奨買入日
   - 勝率
   - 期待リターン
   - 詳細チャート
   - 統計情報

## 3. ウォッチリスト

### 追加方法
1. 銘柄を右クリック
2. 「ウォッチリストに追加」を選択
3. またはCtrl+Dを押す

### 通知設定
最適買入日が近づくとデスクトップ通知が送信されます

## 4. データのエクスポート

### CSV出力
- Ctrl+E または メニュー → エクスポート → CSV
- Excel等で開くことができます

### PDF出力
- Ctrl+P または メニュー → エクスポート → PDF
- 分析レポートとして保存できます

## 5. キーボードショートカット

よく使うショートカット:
- Ctrl+F: 検索
- Ctrl+D: ウォッチリストに追加
- Ctrl+E: CSV出力
- Ctrl+P: PDF出力
- F5: データ更新
- F1: ヘルプ

詳細はF1キーを押してヘルプを表示してください。
"""

    USER_GUIDE = """
# ユーザーガイド

## 概要

Yuutai Event Investorは、株主優待の権利確定日を利用したイベント投資において、
最適な買入タイミングを統計的に予測するツールです。

## 主な機能

### 1. 最適買入日の自動計算
過去10年分の株価データから、最も勝率が高く期待リターンが大きいタイミングを算出します。

### 2. バックテスト分析
- 勝率: リターンがプラスになる確率
- 期待リターン: 期待されるリターンの平均値
- 平均勝ちリターン: 勝ちトレードの平均リターン
- 平均負けリターン: 負けトレードの平均リターン
- 最大リターン: 最も大きく勝ったトレード
- 最大損失: 最も大きく負けたトレード

### 3. フィルター機能
多数の銘柄から条件に合うものを素早く見つけられます。

### 4. ウォッチリスト
気になる銘柄を登録し、買いタイミングの通知を受け取れます。

### 5. データエクスポート
分析結果をCSV、JSON、PDF形式で保存できます。

## 免責事項

本アプリケーションは教育・研究目的で提供されています。
実際の投資判断においては、本アプリケーションの分析結果のみに依存せず、
ご自身の責任で行ってください。

- 過去の実績は将来の結果を保証するものではありません
- 株式投資には元本割れのリスクがあります
- 投資判断は自己責任で行ってください
"""

    FAQ = """
# よくある質問（FAQ）

## Q1. 期待リターンとは何ですか？

A: 期待リターンは、勝率と平均リターンから算出される統計的な期待値です。
計算式: (勝率 × 平均勝ちリターン) + ((1-勝率) × 平均負けリターン)

例: 勝率70%、平均勝ち+5%、平均負け-3%の場合
期待リターン = 0.7 × 5% + 0.3 × (-3%) = 3.5% - 0.9% = +2.6%

## Q2. 勝率はどのように計算されますか？

A: 過去10年分のデータから、指定された買入日でトレードした場合に
リターンがプラスになった確率を算出しています。

## Q3. データはどこから取得していますか？

A: 株価データはyfinanceから、優待情報は96ut.comとyutai.net-ir.ne.jpから
取得しています。

## Q4. データ更新の頻度は？

A: 株価データは自動で更新されますが、優待情報は手動更新が必要です。
メニューバーの「データ更新」ボタンから実行してください。

## Q5. 通知が届きません

A: 以下を確認してください:
1. 設定で通知機能が有効になっているか
2. ウォッチリストに銘柄が登録されているか
3. 最適買入日が今日または近い日付であるか
4. OS側の通知設定が許可されているか

## Q6. バックテストが遅いです

A: 設定から「最大検証日数」を減らすことで高速化できます。
デフォルトは120日（約6ヶ月）ですが、60日や30日に減らすことも可能です。

## Q7. PDFが出力できません

A: reportlabライブラリが必要です。以下のコマンドでインストールしてください:
pip install reportlab

## Q8. エラーが発生しました

A: ログファイルを確認してください。
通常、アプリケーションフォルダの logs ディレクトリに保存されています。
"""


def apply_tooltips_to_widget(widget, tooltip_text: str):
    """
    ウィジェットにツールチップを設定

    Args:
        widget: QWidgetインスタンス
        tooltip_text: ツールチップテキスト
    """
    widget.setToolTip(tooltip_text)


def apply_whats_this_to_widget(widget, whats_this_text: str):
    """
    ウィジェットに「これは何？」テキストを設定

    Args:
        widget: QWidgetインスタンス
        whats_this_text: 「これは何？」テキスト
    """
    widget.setWhatsThis(whats_this_text)
