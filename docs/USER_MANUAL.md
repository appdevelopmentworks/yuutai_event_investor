# 📖 Yuutai Event Investor ユーザーマニュアル

## 目次
1. [はじめに](#はじめに)
2. [インストール](#インストール)
3. [基本的な使い方](#基本的な使い方)
4. [機能詳細](#機能詳細)
5. [FAQ](#faq)
6. [トラブルシューティング](#トラブルシューティング)

---

## はじめに

**Yuutai Event Investor**は、株主優待イベント投資の最適タイミングを分析するツールです。

### 主な機能
- 📊 過去データに基づくバックテスト分析
- 🎯 最適買入日の自動計算
- 📈 勝率・期待リターンの可視化
- 🔍 銘柄フィルタリング機能
- ⭐ ウォッチリスト管理
- 🔔 通知機能
- 📁 CSV/PDFエクスポート

### 動作環境
- **OS**: Windows 10/11（64bit）
- **メモリ**: 4GB以上推奨
- **ディスク**: 500MB以上の空き容量
- **ネットワーク**: インターネット接続必須（データ取得時）

---

## インストール

### 方法1: 実行ファイル版（推奨）

1. リリースページから最新版のZIPファイルをダウンロード
2. 任意のフォルダに解凍
3. `YuutaiEventInvestor.exe`をダブルクリックで起動

### 方法2: Pythonソースコード版

```bash
# 1. リポジトリをクローン
git clone https://github.com/yourusername/yuutai_event_investor.git
cd yuutai_event_investor

# 2. 依存パッケージをインストール
pip install -r requirements.txt

# 3. データベースを初期化
python scripts/init_database.py

# 4. アプリケーションを起動
python main.py
```

---

## 基本的な使い方

### 1. 起動

アプリケーションを起動すると、メインウィンドウが表示されます。

```
┌─────────────────────────────────────────────────────┐
│  Yuutai Event Investor                         _ □ × │
├──────┬────────────────────────┬────────────────────┤
│      │                        │                    │
│フィル│   銘柄リスト            │   詳細分析          │
│ター  │                        │                    │
│パネル│                        │                    │
│      │                        │                    │
└──────┴────────────────────────┴────────────────────┘
```

### 2. 銘柄を選択

中央の**銘柄リスト**から分析したい銘柄をクリックします。

右側の**詳細分析パネル**に以下の情報が表示されます：
- 銘柄情報（コード、名称、権利確定月、優待内容）
- 最適買入日
- 勝率と期待リターン
- 統計情報（トレード数、平均リターンなど）
- チャート（期待値推移、勝率、トレード履歴）

### 3. フィルター機能を使う

左側の**フィルターパネル**で銘柄を絞り込みます：

- **権利確定月**: 特定の月の銘柄のみ表示
- **勝率**: 最小勝率を指定（例: 60%以上）
- **期待リターン**: 最小期待リターンを指定（例: 5%以上）
- **優待ジャンル**: 食品、金券、日用品など

### 4. データを更新

ツールバーの**「データ更新」**ボタンをクリックすると、最新の優待情報を取得します。

⚠️ **注意**: データ更新には5〜10分程度かかります。

---

## 機能詳細

### 📊 チャート表示

詳細分析パネル下部のボタンでチャートを切り替えられます：

#### 1. 期待値推移チャート
権利付最終日の何日前に買うべきかを示す折れ線グラフです。
- 青い線: 期待リターン
- 緑の点: 最適買入日

#### 2. 勝率チャート
各買入日での勝率を棒グラフで表示します。
- 青い棒: 通常の日
- 緑の棒: 最適買入日

#### 3. トレード履歴チャート
勝ち・負けトレードの分布を積み上げ棒グラフで表示します。
- 緑: 勝ちトレード
- 赤: 負けトレード

### ⭐ ウォッチリスト

お気に入りの銘柄を登録できます。

**追加方法:**
1. 銘柄を選択
2. 詳細パネル上部の「ウォッチリストに追加」ボタンをクリック
3. メモを入力（任意）
4. 保存

**確認方法:**
- タブバーの「ウォッチリスト」タブをクリック

**削除方法:**
- ウォッチリストで銘柄を右クリック → 「削除」

### 🔔 通知機能

権利付最終日が近づいたら通知を受け取れます。

**設定方法:**
1. メニュー → 「設定」
2. 「通知」タブを選択
3. 通知タイミングを設定（例: 30日前）
4. デスクトップ通知を有効化

**通知タイミング:**
- アプリ起動時に自動チェック
- バックグラウンドで1時間ごとにチェック（設定で変更可能）

### 📁 エクスポート機能

分析結果をエクスポートできます。

**CSV出力:**
1. 銘柄を選択
2. メニュー → 「エクスポート」 → 「CSVエクスポート」
3. 保存先を選択

**PDF出力:**
1. 銘柄を選択
2. メニュー → 「エクスポート」 → 「PDFエクスポート」
3. 保存先を選択

CSVには以下の情報が含まれます：
- 買入日（権利付最終日の何日前）
- 勝率
- 期待リターン
- トレード数
- 平均リターン

### ⚙️ 設定

**メニュー → 「設定」**から各種設定を変更できます。

#### 一般設定
- **テーマ**: ダーク/ライト/自動
- **言語**: 日本語（現在は日本語のみ）

#### データ設定
- **キャッシュ期間**: 株価データのキャッシュ保持期間（日数）
- **自動更新**: 起動時に自動でデータ更新

#### 通知設定
- **通知有効**: デスクトップ通知のON/OFF
- **通知タイミング**: 何日前に通知するか
- **チェック間隔**: バックグラウンドチェックの間隔

---

## FAQ

### Q1: 初回起動時にデータが表示されない
A: データベースが初期化されていない可能性があります。
```bash
python scripts/init_database.py
```
を実行してください。

### Q2: 「データ取得エラー」と表示される
A: 以下を確認してください：
- インターネット接続
- yfinanceのサーバー状態
- 銘柄コードが正しいか

一時的なエラーの場合、時間をおいて再試行してください。

### Q3: バックテスト結果が表示されない
A: 以下の原因が考えられます：
- 株価データが取得できない（上場廃止など）
- 権利確定日が設定されていない
- 過去データが不足している

### Q4: 通知が来ない
A: 設定を確認してください：
1. 設定 → 通知 → 「通知有効」がONか
2. Windowsの通知設定でアプリが許可されているか
3. ウォッチリストに銘柄が登録されているか

### Q5: 最適買入日はどうやって計算されるの？
A: 過去10年分の株価データを使ってバックテストを行い、期待リターンが最大になる日を算出しています。

計算式:
```
期待リターン = (平均勝ちリターン × 勝率) + (平均負けリターン × (1 - 勝率))
```

---

## トラブルシューティング

### アプリが起動しない

**原因1: 必要なファイルがない**
- 解決策: 再ダウンロード、または再インストール

**原因2: ウイルス対策ソフトがブロック**
- 解決策: 除外設定に追加

**原因3: .NET Frameworkが古い**
- 解決策: Windows Updateを実行

### 動作が重い

**対策1: キャッシュをクリア**
```bash
# データベースのvacuum
sqlite3 data/yuutai.db "VACUUM;"
```

**対策2: 古いデータを削除**
```sql
DELETE FROM price_history WHERE updated_at < date('now', '-365 days');
```

**対策3: フィルターを使う**
- 表示する銘柄数を減らす

### エラーログの確認

ログファイルは以下の場所に保存されます：
```
logs/yuutai_event_investor.log
```

エラー報告時にはこのログファイルを添付してください。

---

## サポート

### バグ報告
GitHubのIssueページでバグを報告してください：
https://github.com/yourusername/yuutai_event_investor/issues

### 機能要望
同じくIssueページで「enhancement」ラベルを付けて投稿してください。

### お問い合わせ
- GitHub Issues（推奨）
- Email: your.email@example.com

---

## ライセンス

MIT License

---

## 免責事項

本ソフトウェアは投資判断の参考情報を提供するものであり、投資を推奨するものではありません。
投資は自己責任で行ってください。本ソフトウェアの使用により生じた損失について、作者は一切の責任を負いません。

---

**最終更新:** 2025-11-07
**バージョン:** 1.0.0
